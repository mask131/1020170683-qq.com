// Sample demo for QuickLZ 1.5.x

// Remember to define QLZ_COMPRESSION_LEVEL and QLZ_STREAMING_MODE to the same values for the compressor and decompressor

#include <stdio.h>
#include <stdlib.h>

#include "fastlz.h"

int main(int argc, char* argv[])
{

    unsigned short in_buf[] = {3026, 3026, 3026, 4552, 522, 1657, 522, 522, 522, 1657, 522, 522, 522, 522, 522, 1657, 522,\
                                1657, 522, 522, 522, 1657, 522, 522, 522, 1657, 522, 522, 522, 522, 522, 522, 522, 1657, \
                                522, 522, 522, 1657, 522, 1657, 522, 1657, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                1657, 522, 522, 522, 1657, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 1657, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                1657, 522, 522, 522, 1657, 522, 1657, 522, 1657, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 522, 1657, 522, 522, 522, 1657, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 1657, 522, 522, 522, 522, 522, 1657, 522, 522, 522, 1657, 522, 1657, 522, 522, \
                                522, 1657, 522, 522, 522, 1657, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 1657, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, 522, \
                                522, 522, 522, 1657, 522, 522, 522, 1657, 522, 1657, 522, 522, 522, 1657, 522, 1657, 522, 1657, 522, 1000};




    // allocate source buffer and read file
    int len1 = sizeof(in_buf);
    printf("压缩前:%d\r\n",len1);


    // compress
    char *out_buf1 = (char*) malloc(len1);
    int len2 = fastlz_compress_level(1,in_buf, len1, out_buf1);
    printf("压缩后:%d\r\n",len2);
    for(int i = 0; i < len2; i++)
    {
        printf("%04d ",(unsigned char)out_buf1[i]);
    }
    printf("\r\n");

    //decompress
    printf("需要解压的长度:%d\r\n",len2);
    char *out_buf2 = (char*) malloc(len1);
    int len3 = fastlz_decompress(out_buf1,len2, out_buf2,len1);
    printf("解压后:%d\r\n",len3);
    for(int i = 0; i < len3; i+=2)
    {
        printf("%d ",(unsigned short)out_buf2[i+1]<<8 | (unsigned short)out_buf2[i]&0x00FF);
    }
    printf("\r\n");  
    return 0;

}